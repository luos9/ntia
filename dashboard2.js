// var freqData=[
//     {'State':'Home','freq':{'7-22':314, '23-38':428, '39-52':340, '53-71':433, '72+':167}}
//     ,{'State':'Work','freq':{'7-22':20, '23-38':262, '39-52':218, '53-71':193, '72+':8}}
//     ,{'State':'Travel','freq':{'7-22':257, '23-38':332, '39-52':273, '53-71':259, '72+':47}}
//     ,{'State':'School','freq':{'7-22':212, '23-38':35, '39-52':10, '53-71':9, '72+':21}}
//     ,{'State':'OthersHome','freq':{'7-22':140, '23-38':202, '39-52':130, '53-71':130, '72+':43}}
//     ,{'State':'Public','freq':{'7-22':115, '23-38':137, '39-52':111, '53-71':91, '72+':31}}
//     ,{'State':'Cafe','freq':{'7-22':78, '23-38':168, '39-52':130, '53-71':109, '72+':19}}
//     ,{'State':'Others','freq':{'7-22':4, '23-38':16, '39-52':10, '53-71':16, '72+':2}}
//     ];

var totalData = {'7-22':449, '23-38':532, '39-52':433, '53-71':587, '72+':412};
function dashboard(id, fData){
    var barColor = 'steelblue';
    function segColor(c){ return {'7-22':"#a6d854", '23-38':"#66c2a5",'39-52':"#fc8d62",'53-71':"#e78ac3",'72+':"#8da0cb"}[c]; }
     
    // compute total for each state.
    fData.forEach(function(d){d.total=d.freq['7-22']+d.freq['23-38']+d.freq['39-52']+d.freq['53-71']+d.freq['72+'];});
    fData.forEach(function(f){f.sumup=f.sum});
    
    // function to handle histogram.
    function histoGram(fD){
        var hG={},    hGDim = {t: 60, r: 0, b: 30, l: 0};
        hGDim.w = 500 - hGDim.l - hGDim.r, 
        hGDim.h = 300 - hGDim.t - hGDim.b;
            
        //create svg for histogram.
        var hGsvg = d3.select(id).append("svg")
            .attr("width", hGDim.w + hGDim.l + hGDim.r)
            .attr("height", hGDim.h + hGDim.t + hGDim.b).append("g")
            .attr("transform", "translate(" + hGDim.l + "," + hGDim.t + ")");

        // create function for x-axis mapping.
        var x = d3.scaleBand().rangeRound([0, hGDim.w], 0.1)
                .domain(fD.map(function(d) { return d[0]; }));

        // Add x-axis to the histogram svg.
        hGsvg.append("g").attr("class", "x axis")
            .attr("transform", "translate(0," + hGDim.h + ")")
            .call(d3.axisBottom(x));

        // Create function for y-axis map.
        var y = d3.scaleLinear().range([hGDim.h, 0])
                .domain([0, d3.max(fD, function(d) { return d[1]; })]);

        // Create bars for histogram to contain rectangles and freq labels.
        var bars = hGsvg.selectAll(".bar").data(fD).enter()
                .append("g").attr("class", "bar");
        
        //create the rectangles.
        bars.append("rect")
            .attr("x", function(d) { return x(d[0]); })
            .attr("y", function(d) { return y(d[1]); })
            .attr("width", x.bandwidth()*0.85)
            .attr("height", function(d) { return hGDim.h - y(d[1]); })
            .attr('fill',barColor)
            .on("mouseover",mouseover)// mouseover is defined below.
            .on("mouseout",mouseout);// mouseout is defined below.
            
        //Create the frequency labels above the rectangles.
        bars.append("text").text(function(d){ return d3.format(",.1%")(d[1])})
            .attr("x", function(d) { return x(d[0])+x.bandwidth()/2; })
            .attr("y", function(d) { return y(d[1])-5; })
            .attr("text-anchor", "middle");
        
        function mouseover(d){  // utility function to be called on mouseover.
            // filter for selected state.
            var st = fData.filter(function(s){ return s.State == d[0];})[0],
                nD = d3.keys(st.freq).map(function(s){ return {type:s, freq:st.freq[s]};});
            //console.log(nD)
            // call update functions of pie-chart and legend.    
            pC.update(nD);
            leg.update(nD);
        }
        
        function mouseout(d){    // utility function to be called on mouseout.
            // reset the pie-chart and legend.    
            pC.update(tF);
            leg.update(tF);
        }
        
        // create function to update the bars. This will be used by pie-chart.
        hG.update = function(nD, color){
            // update the domain of the y-axis map to reflect change in frequencies.
            y.domain([0, d3.max(nD, function(d) { return d[1]; })]);
            
            // Attach the new data to the bars.
            var bars = hGsvg.selectAll(".bar").data(nD);
            //console.log(nD)
            
            // transition the height and color of rectangles.
            bars.select("rect").transition().duration(500)
                .attr("y", function(d) {return y(d[1]); })
                .attr("height", function(d) { return hGDim.h - y(d[1]); })
                .attr("fill", color);

            // transition the frequency labels location and change value.
            bars.select("text").transition().duration(500)
                .text(function(d){ return d3.format(",.1%")(d[1])})
                .attr("y", function(d) {return y(d[1])-5; });            
        }        
        return hG;
    }
    
    // function to handle pieChart.
    function pieChart(pD){
        var pC ={},    pieDim ={w:300, h: 250};
        pieDim.r = Math.min(pieDim.w, pieDim.h) / 2;
                
        // create svg for pie chart.
        var piesvg = d3.select(id).append("svg")
            .attr("width", pieDim.w).attr("height", pieDim.h).append("g")
            .attr("transform", "translate("+pieDim.w/2+","+pieDim.h/2+")");
        
        // create function to draw the arcs of the pie slices.
        var arc = d3.arc().outerRadius(pieDim.r - 10).innerRadius(0);

        // create a function to compute the pie slice angles.
        var pie = d3.pie().sort(null).value(function(d) { return d.freq; });

        // Draw the pie slices.
        piesvg.selectAll("path").data(pie(pD)).enter().append("path").attr("d", arc)
            .each(function(d) { this._current = d; })
            .style("fill", function(d) { return segColor(d.data.type); })
            .on("mouseover",mouseover).on("mouseout",mouseout);

        // create function to update pie-chart. This will be used by histogram.
        pC.update = function(nD){
            piesvg.selectAll("path").data(pie(nD)).transition().duration(500)
                .attrTween("d", arcTween);
        }        
        // Utility function to be called on mouseover a pie slice.
        function mouseover(d){
            // call the update function of histogram with new data.
            hG.update(fData.map(function(v){ 
                return [v.State,d3.format(",.4f")(v.freq[d.data.type]/totalData[d.data.type])];}),segColor(d.data.type));
        }
        //Utility function to be called on mouseout a pie slice.
        function mouseout(d){
            // call the update function of histogram with all data.
            hG.update(fData.map(function(v){
                return [v.State,d3.format(",.4f")(v.total/v.sumup)];}), barColor);
        }
        // Animating the pie-slice requiring a custom function which specifies
        // how the intermediate paths should be drawn.
        function arcTween(a) {
            var i = d3.interpolate(this._current, a);
            this._current = i(0);
            return function(t) { return arc(i(t));    };
        }    
        return pC;
    }
    
    // function to handle legend.
    function legend(lD){
        var leg = {};
            
        // create table for legend.
        var legend = d3.select(id).append("table").attr('class','legend');
        
        // create one row per segment.
        var tr = legend.append("tbody").selectAll("tr").data(lD).enter().append("tr");
            
        // create the first column for each segment.
        tr.append("td").append("svg").attr("width", '16').attr("height", '16').append("rect")
            .attr("width", '16').attr("height", '16')
			.attr("fill",function(d){ return segColor(d.type); });
            
        // create the second column for each segment.
        tr.append("td").text(function(d){ return d.type;});

        // create the third column for each segment.
        //tr.append("td").attr("class",'legendFreq')
            //.text(function(d){ return d3.format(",")(d.freq);});

        // create the fourth column for each segment.
        tr.append("td").attr("class",'legendPerc')
            .text(function(d){ return getLegend(d,lD);});

        // Utility function to be used to update the legend.
        leg.update = function(nD){
            // update the data attached to the row elements.
            var l = legend.select("tbody").selectAll("tr").data(nD);

            // update the frequencies.
            l.select(".legendFreq").text(function(d){ return d3.format(",")(d.freq);});

            // update the percentage column.
            l.select(".legendPerc").text(function(d){ return getLegend(d,nD);});        
        }
        
        function getLegend(d,aD){ // Utility function to compute percentage.
            return d3.format(",.1%")(d.freq/d3.sum(aD.map(function(v){ return v.freq; })));
        }

        return leg;
    }
    
    // calculate total frequency by segment for all state.
    var tF = ['7-22','23-38','39-52','53-71','72+'].map(function(d){ 
        return {type:d, freq: d3.sum(fData.map(function(t){ return t.freq[d];}))}; 
    });    
    
    // calculate total frequency by state for all segment.
    var sF = fData.map(function(d){return [d.State,(d3.format(",.4f")(d.total/d.sumup))];});

    var hG = histoGram(sF), // create the histogram.
        pC = pieChart(tF), // create the pie-chart.
        leg= legend(tF);  // create the legend.
}

var data = ["People who use internet for emails", "People who use internet for job search", "People who use internet for entertainment", "Other purposes of using internet..."];

var select = d3.select('#dropdown')
  .append('select')
  	.attr('class','select')
    .on('change',onchange)

var options = select
  .selectAll('option')
	.data(data).enter()
	.append('option')
		.text(function (d) { return d; });

function onchange() {
	selectValue = d3.select('select').property('value')
	//d3.select('body')
		//.append('p')
		//.text(selectValue + ' is the last selected option.')
};


//data
var pie_data = {'Alabama': [{'State': 'Home',
'freq': {'23-38': 330, '39-52': 335, '53-71': 390, '7-22': 333, '72+': 91},
'sum': 2294},
{'State': 'Work',
'freq': {'23-38': 183, '39-52': 207, '53-71': 160, '7-22': 18, '72+': 7},
'sum': 2294},
{'State': 'Travel',
'freq': {'23-38': 176, '39-52': 168, '53-71': 150, '7-22': 123, '72+': 25},
'sum': 2294},
{'State': 'Public',
'freq': {'23-38': 82, '39-52': 75, '53-71': 49, '7-22': 97, '72+': 7},
'sum': 2294},
{'State': 'OthersHome',
'freq': {'23-38': 105, '39-52': 103, '53-71': 66, '7-22': 113, '72+': 6},
'sum': 2294},
{'State': 'School',
'freq': {'23-38': 69, '39-52': 80, '53-71': 41, '7-22': 64, '72+': 7},
'sum': 2294},
{'State': 'Cafe',
'freq': {'23-38': 35, '39-52': 18, '53-71': 5, '7-22': 244, '72+': 0},
'sum': 2294},
{'State': 'Others',
'freq': {'23-38': 3, '39-52': 10, '53-71': 11, '7-22': 7, '72+': 4},
'sum': 2294}],
'Alaska': [{'State': 'Home',
'freq': {'23-38': 303, '39-52': 217, '53-71': 228, '7-22': 249, '72+': 37},
'sum': 1393},
{'State': 'Work',
'freq': {'23-38': 179, '39-52': 149, '53-71': 107, '7-22': 24, '72+': 3},
'sum': 1393},
{'State': 'Travel',
'freq': {'23-38': 176, '39-52': 124, '53-71': 106, '7-22': 96, '72+': 13},
'sum': 1393},
{'State': 'Public',
'freq': {'23-38': 84, '39-52': 54, '53-71': 49, '7-22': 67, '72+': 7},
'sum': 1393},
{'State': 'OthersHome',
'freq': {'23-38': 113, '39-52': 76, '53-71': 54, '7-22': 86, '72+': 10},
'sum': 1393},
{'State': 'School',
'freq': {'23-38': 93, '39-52': 63, '53-71': 43, '7-22': 53, '72+': 5},
'sum': 1393},
{'State': 'Cafe',
'freq': {'23-38': 34, '39-52': 14, '53-71': 9, '7-22': 179, '72+': 0},
'sum': 1393},
{'State': 'Others',
'freq': {'23-38': 4, '39-52': 9, '53-71': 10, '7-22': 7, '72+': 3},
'sum': 1393}],
'Arizona': [{'State': 'Home',
'freq': {'23-38': 293, '39-52': 230, '53-71': 284, '7-22': 303, '72+': 82},
'sum': 1861},
{'State': 'Work',
'freq': {'23-38': 170, '39-52': 147, '53-71': 112, '7-22': 21, '72+': 3},
'sum': 1861},
{'State': 'Travel',
'freq': {'23-38': 177, '39-52': 115, '53-71': 134, '7-22': 102, '72+': 30},
'sum': 1861},
{'State': 'Public',
'freq': {'23-38': 75, '39-52': 29, '53-71': 39, '7-22': 93, '72+': 6},
'sum': 1861},
{'State': 'OthersHome',
'freq': {'23-38': 112, '39-52': 50, '53-71': 62, '7-22': 97, '72+': 17},
'sum': 1861},
{'State': 'School',
'freq': {'23-38': 86, '39-52': 48, '53-71': 44, '7-22': 48, '72+': 5},
'sum': 1861},
{'State': 'Cafe',
'freq': {'23-38': 32, '39-52': 10, '53-71': 7, '7-22': 235, '72+': 0},
'sum': 1861},
{'State': 'Others',
'freq': {'23-38': 7, '39-52': 3, '53-71': 10, '7-22': 5, '72+': 1},
'sum': 1861}],
'Arkansas': [{'State': 'Home',
'freq': {'23-38': 335, '39-52': 308, '53-71': 324, '7-22': 346, '72+': 49},
'sum': 2108},
{'State': 'Work',
'freq': {'23-38': 202, '39-52': 177, '53-71': 133, '7-22': 29, '72+': 8},
'sum': 2108},
{'State': 'Travel',
'freq': {'23-38': 172, '39-52': 124, '53-71': 127, '7-22': 122, '72+': 16},
'sum': 2108},
{'State': 'Public',
'freq': {'23-38': 89, '39-52': 65, '53-71': 34, '7-22': 98, '72+': 5},
'sum': 2108},
{'State': 'OthersHome',
'freq': {'23-38': 128, '39-52': 76, '53-71': 54, '7-22': 124, '72+': 7},
'sum': 2108},
{'State': 'School',
'freq': {'23-38': 80, '39-52': 58, '53-71': 49, '7-22': 81, '72+': 2},
'sum': 2108},
{'State': 'Cafe',
'freq': {'23-38': 39, '39-52': 21, '53-71': 9, '7-22': 250, '72+': 0},
'sum': 2108},
{'State': 'Others',
'freq': {'23-38': 11, '39-52': 7, '53-71': 8, '7-22': 7, '72+': 1},
'sum': 2108}],
'California': [{'State': 'Home',
'freq': {'23-38': 1785,
 '39-52': 1497,
 '53-71': 1560,
 '7-22': 1610,
 '72+': 367},
'sum': 10062},
{'State': 'Work',
'freq': {'23-38': 997, '39-52': 885, '53-71': 733, '7-22': 125, '72+': 41},
'sum': 10062},
{'State': 'Travel',
'freq': {'23-38': 1039,
 '39-52': 851,
 '53-71': 753,
 '7-22': 590,
 '72+': 123},
'sum': 10062},
{'State': 'Public',
'freq': {'23-38': 515, '39-52': 329, '53-71': 290, '7-22': 563, '72+': 29},
'sum': 10062},
{'State': 'OthersHome',
'freq': {'23-38': 690, '39-52': 465, '53-71': 408, '7-22': 548, '72+': 73},
'sum': 10062},
{'State': 'School',
'freq': {'23-38': 600, '39-52': 399, '53-71': 380, '7-22': 356, '72+': 47},
'sum': 10062},
{'State': 'Cafe',
'freq': {'23-38': 227, '39-52': 79, '53-71': 38, '7-22': 1158, '72+': 3},
'sum': 10062},
{'State': 'Others',
'freq': {'23-38': 66, '39-52': 40, '53-71': 43, '7-22': 33, '72+': 10},
'sum': 10062}],
'Colorado': [{'State': 'Home',
'freq': {'23-38': 259, '39-52': 245, '53-71': 258, '7-22': 205, '72+': 47},
'sum': 1468},
{'State': 'Work',
'freq': {'23-38': 172, '39-52': 174, '53-71': 127, '7-22': 15, '72+': 2},
'sum': 1468},
{'State': 'Travel',
'freq': {'23-38': 188, '39-52': 155, '53-71': 119, '7-22': 85, '72+': 14},
'sum': 1468},
{'State': 'Public',
'freq': {'23-38': 96, '39-52': 88, '53-71': 60, '7-22': 85, '72+': 10},
'sum': 1468},
{'State': 'OthersHome',
'freq': {'23-38': 126, '39-52': 98, '53-71': 72, '7-22': 105, '72+': 6},
'sum': 1468},
{'State': 'School',
'freq': {'23-38': 108, '39-52': 95, '53-71': 71, '7-22': 52, '72+': 15},
'sum': 1468},
{'State': 'Cafe',
'freq': {'23-38': 31, '39-52': 14, '53-71': 12, '7-22': 175, '72+': 0},
'sum': 1468},
{'State': 'Others',
'freq': {'23-38': 13, '39-52': 9, '53-71': 11, '7-22': 3, '72+': 0},
'sum': 1468}],
'Connecticut': [{'State': 'Home',
'freq': {'23-38': 193, '39-52': 217, '53-71': 244, '7-22': 218, '72+': 52},
'sum': 1253},
{'State': 'Work',
'freq': {'23-38': 128, '39-52': 131, '53-71': 127, '7-22': 21, '72+': 6},
'sum': 1253},
{'State': 'Travel',
'freq': {'23-38': 109, '39-52': 105, '53-71': 94, '7-22': 62, '72+': 13},
'sum': 1253},
{'State': 'Public',
'freq': {'23-38': 56, '39-52': 49, '53-71': 55, '7-22': 60, '72+': 7},
'sum': 1253},
{'State': 'OthersHome',
'freq': {'23-38': 85, '39-52': 77, '53-71': 58, '7-22': 77, '72+': 9},
'sum': 1253},
{'State': 'School',
'freq': {'23-38': 68, '39-52': 43, '53-71': 35, '7-22': 37, '72+': 3},
'sum': 1253},
{'State': 'Cafe',
'freq': {'23-38': 15, '39-52': 13, '53-71': 8, '7-22': 155, '72+': 0},
'sum': 1253},
{'State': 'Others',
'freq': {'23-38': 10, '39-52': 6, '53-71': 11, '7-22': 3, '72+': 2},
'sum': 1253}],
'Delaware': [{'State': 'Home',
'freq': {'23-38': 201, '39-52': 184, '53-71': 244, '7-22': 187, '72+': 64},
'sum': 1233},
{'State': 'Work',
'freq': {'23-38': 132, '39-52': 121, '53-71': 124, '7-22': 14, '72+': 9},
'sum': 1233},
{'State': 'Travel',
'freq': {'23-38': 103, '39-52': 87, '53-71': 109, '7-22': 38, '72+': 14},
'sum': 1233},
{'State': 'Public',
'freq': {'23-38': 61, '39-52': 41, '53-71': 38, '7-22': 72, '72+': 11},
'sum': 1233},
{'State': 'OthersHome',
'freq': {'23-38': 66, '39-52': 57, '53-71': 68, '7-22': 54, '72+': 12},
'sum': 1233},
{'State': 'School',
'freq': {'23-38': 50, '39-52': 40, '53-71': 40, '7-22': 35, '72+': 4},
'sum': 1233},
{'State': 'Cafe',
'freq': {'23-38': 20, '39-52': 13, '53-71': 4, '7-22': 152, '72+': 2},
'sum': 1233},
{'State': 'Others',
'freq': {'23-38': 4, '39-52': 5, '53-71': 10, '7-22': 0, '72+': 2},
'sum': 1233}],
'District of Columbia': [{'State': 'Home',
'freq': {'23-38': 513, '39-52': 272, '53-71': 222, '7-22': 173, '72+': 57},
'sum': 1734},
{'State': 'Work',
'freq': {'23-38': 406, '39-52': 203, '53-71': 130, '7-22': 38, '72+': 16},
'sum': 1734},
{'State': 'Travel',
'freq': {'23-38': 376, '39-52': 183, '53-71': 145, '7-22': 77, '72+': 26},
'sum': 1734},
{'State': 'Public',
'freq': {'23-38': 208, '39-52': 96, '53-71': 71, '7-22': 112, '72+': 14},
'sum': 1734},
{'State': 'OthersHome',
'freq': {'23-38': 317, '39-52': 115, '53-71': 75, '7-22': 85, '72+': 18},
'sum': 1734},
{'State': 'School',
'freq': {'23-38': 297, '39-52': 107, '53-71': 82, '7-22': 54, '72+': 12},
'sum': 1734},
{'State': 'Cafe',
'freq': {'23-38': 74, '39-52': 13, '53-71': 9, '7-22': 117, '72+': 2},
'sum': 1734},
{'State': 'Others',
'freq': {'23-38': 32, '39-52': 19, '53-71': 11, '7-22': 3, '72+': 2},
'sum': 1734}],
'Florida': [{'State': 'Home',
'freq': {'23-38': 773, '39-52': 733, '53-71': 875, '7-22': 669, '72+': 238},
'sum': 4928},
{'State': 'Work',
'freq': {'23-38': 445, '39-52': 411, '53-71': 375, '7-22': 62, '72+': 19},
'sum': 4928},
{'State': 'Travel',
'freq': {'23-38': 379, '39-52': 334, '53-71': 380, '7-22': 200, '72+': 73},
'sum': 4928},
{'State': 'Public',
'freq': {'23-38': 195, '39-52': 160, '53-71': 141, '7-22': 228, '72+': 22},
'sum': 4928},
{'State': 'OthersHome',
'freq': {'23-38': 262, '39-52': 167, '53-71': 156, '7-22': 177, '72+': 25},
'sum': 4928},
{'State': 'School',
'freq': {'23-38': 192, '39-52': 160, '53-71': 135, '7-22': 124, '72+': 26},
'sum': 4928},
{'State': 'Cafe',
'freq': {'23-38': 117, '39-52': 45, '53-71': 20, '7-22': 445, '72+': 1},
'sum': 4928},
{'State': 'Others',
'freq': {'23-38': 12, '39-52': 12, '53-71': 14, '7-22': 3, '72+': 3},
'sum': 4928}],
'Georgia': [{'State': 'Home',
'freq': {'23-38': 461, '39-52': 378, '53-71': 361, '7-22': 388, '72+': 60},
'sum': 2476},
{'State': 'Work',
'freq': {'23-38': 248, '39-52': 230, '53-71': 168, '7-22': 23, '72+': 4},
'sum': 2476},
{'State': 'Travel',
'freq': {'23-38': 276, '39-52': 207, '53-71': 156, '7-22': 158, '72+': 15},
'sum': 2476},
{'State': 'Public',
'freq': {'23-38': 146, '39-52': 115, '53-71': 69, '7-22': 129, '72+': 8},
'sum': 2476},
{'State': 'OthersHome',
'freq': {'23-38': 169, '39-52': 134, '53-71': 88, '7-22': 137, '72+': 5},
'sum': 2476},
{'State': 'School',
'freq': {'23-38': 126, '39-52': 108, '53-71': 71, '7-22': 84, '72+': 11},
'sum': 2476},
{'State': 'Cafe',
'freq': {'23-38': 73, '39-52': 25, '53-71': 13, '7-22': 317, '72+': 1},
'sum': 2476},
{'State': 'Others',
'freq': {'23-38': 23, '39-52': 19, '53-71': 7, '7-22': 9, '72+': 4},
'sum': 2476}],
'Hawaii': [{'State': 'Home',
'freq': {'23-38': 285, '39-52': 251, '53-71': 306, '7-22': 279, '72+': 62},
'sum': 1808},
{'State': 'Work',
'freq': {'23-38': 161, '39-52': 169, '53-71': 125, '7-22': 28, '72+': 8},
'sum': 1808},
{'State': 'Travel',
'freq': {'23-38': 173, '39-52': 146, '53-71': 128, '7-22': 101, '72+': 18},
'sum': 1808},
{'State': 'Public',
'freq': {'23-38': 95, '39-52': 61, '53-71': 63, '7-22': 85, '72+': 10},
'sum': 1808},
{'State': 'OthersHome',
'freq': {'23-38': 99, '39-52': 74, '53-71': 56, '7-22': 103, '72+': 6},
'sum': 1808},
{'State': 'School',
'freq': {'23-38': 92, '39-52': 63, '53-71': 61, '7-22': 53, '72+': 8},
'sum': 1808},
{'State': 'Cafe',
'freq': {'23-38': 29, '39-52': 8, '53-71': 8, '7-22': 192, '72+': 2},
'sum': 1808},
{'State': 'Others',
'freq': {'23-38': 8, '39-52': 3, '53-71': 7, '7-22': 3, '72+': 3},
'sum': 1808}],
'Idaho': [{'State': 'Home',
'freq': {'23-38': 360, '39-52': 256, '53-71': 345, '7-22': 347, '72+': 69},
'sum': 1768},
{'State': 'Work',
'freq': {'23-38': 216, '39-52': 173, '53-71': 155, '7-22': 33, '72+': 4},
'sum': 1768},
{'State': 'Travel',
'freq': {'23-38': 243, '39-52': 149, '53-71': 153, '7-22': 126, '72+': 25},
'sum': 1768},
{'State': 'Public',
'freq': {'23-38': 109, '39-52': 53, '53-71': 46, '7-22': 101, '72+': 13},
'sum': 1768},
{'State': 'OthersHome',
'freq': {'23-38': 163, '39-52': 84, '53-71': 100, '7-22': 131, '72+': 14},
'sum': 1768},
{'State': 'School',
'freq': {'23-38': 134, '39-52': 74, '53-71': 69, '7-22': 68, '72+': 8},
'sum': 1768},
{'State': 'Cafe',
'freq': {'23-38': 44, '39-52': 18, '53-71': 9, '7-22': 248, '72+': 1},
'sum': 1768},
{'State': 'Others',
'freq': {'23-38': 9, '39-52': 7, '53-71': 17, '7-22': 6, '72+': 1},
'sum': 1768}],
'Illinois': [{'State': 'Home',
'freq': {'23-38': 649, '39-52': 584, '53-71': 672, '7-22': 677, '72+': 133},
'sum': 3545},
{'State': 'Work',
'freq': {'23-38': 413, '39-52': 372, '53-71': 332, '7-22': 58, '72+': 18},
'sum': 3545},
{'State': 'Travel',
'freq': {'23-38': 427, '39-52': 322, '53-71': 331, '7-22': 269, '72+': 54},
'sum': 3545},
{'State': 'Public',
'freq': {'23-38': 208, '39-52': 124, '53-71': 146, '7-22': 239, '72+': 25},
'sum': 3545},
{'State': 'OthersHome',
'freq': {'23-38': 305, '39-52': 175, '53-71': 174, '7-22': 274, '72+': 24},
'sum': 3545},
{'State': 'School',
'freq': {'23-38': 223, '39-52': 170, '53-71': 147, '7-22': 167, '72+': 17},
'sum': 3545},
{'State': 'Cafe',
'freq': {'23-38': 78, '39-52': 17, '53-71': 10, '7-22': 525, '72+': 2},
'sum': 3545},
{'State': 'Others',
'freq': {'23-38': 21, '39-52': 18, '53-71': 34, '7-22': 14, '72+': 3},
'sum': 3545}],
'Indiana': [{'State': 'Home',
'freq': {'23-38': 303, '39-52': 301, '53-71': 307, '7-22': 275, '72+': 82},
'sum': 1747},
{'State': 'Work',
'freq': {'23-38': 167, '39-52': 198, '53-71': 147, '7-22': 22, '72+': 6},
'sum': 1747},
{'State': 'Travel',
'freq': {'23-38': 159, '39-52': 157, '53-71': 126, '7-22': 103, '72+': 22},
'sum': 1747},
{'State': 'Public',
'freq': {'23-38': 67, '39-52': 85, '53-71': 51, '7-22': 107, '72+': 6},
'sum': 1747},
{'State': 'OthersHome',
'freq': {'23-38': 109, '39-52': 100, '53-71': 72, '7-22': 102, '72+': 10},
'sum': 1747},
{'State': 'School',
'freq': {'23-38': 75, '39-52': 86, '53-71': 50, '7-22': 69, '72+': 1},
'sum': 1747},
{'State': 'Cafe',
'freq': {'23-38': 39, '39-52': 10, '53-71': 10, '7-22': 216, '72+': 1},
'sum': 1747},
{'State': 'Others',
'freq': {'23-38': 13, '39-52': 8, '53-71': 19, '7-22': 3, '72+': 2},
'sum': 1747}],
'Iowa': [{'State': 'Home',
'freq': {'23-38': 253, '39-52': 178, '53-71': 216, '7-22': 246, '72+': 53},
'sum': 1294},
{'State': 'Work',
'freq': {'23-38': 177, '39-52': 128, '53-71': 117, '7-22': 30, '72+': 4},
'sum': 1294},
{'State': 'Travel',
'freq': {'23-38': 148, '39-52': 97, '53-71': 102, '7-22': 86, '72+': 7},
'sum': 1294},
{'State': 'Public',
'freq': {'23-38': 84, '39-52': 48, '53-71': 62, '7-22': 72, '72+': 6},
'sum': 1294},
{'State': 'OthersHome',
'freq': {'23-38': 129, '39-52': 69, '53-71': 61, '7-22': 128, '72+': 5},
'sum': 1294},
{'State': 'School',
'freq': {'23-38': 87, '39-52': 57, '53-71': 44, '7-22': 56, '72+': 4},
'sum': 1294},
{'State': 'Cafe',
'freq': {'23-38': 31, '39-52': 6, '53-71': 11, '7-22': 180, '72+': 0},
'sum': 1294},
{'State': 'Others',
'freq': {'23-38': 8, '39-52': 4, '53-71': 10, '7-22': 3, '72+': 1},
'sum': 1294}],
'Kansas': [{'State': 'Home',
'freq': {'23-38': 237, '39-52': 183, '53-71': 216, '7-22': 226, '72+': 50},
'sum': 1350},
{'State': 'Work',
'freq': {'23-38': 152, '39-52': 117, '53-71': 102, '7-22': 23, '72+': 5},
'sum': 1350},
{'State': 'Travel',
'freq': {'23-38': 137, '39-52': 99, '53-71': 100, '7-22': 88, '72+': 13},
'sum': 1350},
{'State': 'Public',
'freq': {'23-38': 62, '39-52': 39, '53-71': 33, '7-22': 46, '72+': 6},
'sum': 1350},
{'State': 'OthersHome',
'freq': {'23-38': 95, '39-52': 53, '53-71': 52, '7-22': 80, '72+': 6},
'sum': 1350},
{'State': 'School',
'freq': {'23-38': 70, '39-52': 40, '53-71': 35, '7-22': 34, '72+': 6},
'sum': 1350},
{'State': 'Cafe',
'freq': {'23-38': 29, '39-52': 13, '53-71': 10, '7-22': 175, '72+': 6},
'sum': 1350},
{'State': 'Others',
'freq': {'23-38': 8, '39-52': 4, '53-71': 6, '7-22': 4, '72+': 0},
'sum': 1350}],
'Kentucky': [{'State': 'Home',
'freq': {'23-38': 258, '39-52': 271, '53-71': 276, '7-22': 250, '72+': 55},
'sum': 1606},
{'State': 'Work',
'freq': {'23-38': 145, '39-52': 153, '53-71': 113, '7-22': 18, '72+': 4},
'sum': 1606},
{'State': 'Travel',
'freq': {'23-38': 145, '39-52': 132, '53-71': 117, '7-22': 101, '72+': 15},
'sum': 1606},
{'State': 'Public',
'freq': {'23-38': 53, '39-52': 64, '53-71': 50, '7-22': 77, '72+': 7},
'sum': 1606},
{'State': 'OthersHome',
'freq': {'23-38': 116, '39-52': 88, '53-71': 80, '7-22': 96, '72+': 18},
'sum': 1606},
{'State': 'School',
'freq': {'23-38': 61, '39-52': 65, '53-71': 55, '7-22': 53, '72+': 5},
'sum': 1606},
{'State': 'Cafe',
'freq': {'23-38': 24, '39-52': 10, '53-71': 7, '7-22': 196, '72+': 1},
'sum': 1606},
{'State': 'Others',
'freq': {'23-38': 5, '39-52': 8, '53-71': 6, '7-22': 1, '72+': 1},
'sum': 1606}],
'Louisiana': [{'State': 'Home',
'freq': {'23-38': 484, '39-52': 366, '53-71': 428, '7-22': 419, '72+': 68},
'sum': 2659},
{'State': 'Work',
'freq': {'23-38': 294, '39-52': 215, '53-71': 216, '7-22': 43, '72+': 10},
'sum': 2659},
{'State': 'Travel',
'freq': {'23-38': 266, '39-52': 204, '53-71': 163, '7-22': 177, '72+': 19},
'sum': 2659},
{'State': 'Public',
'freq': {'23-38': 134, '39-52': 87, '53-71': 68, '7-22': 165, '72+': 5},
'sum': 2659},
{'State': 'OthersHome',
'freq': {'23-38': 201, '39-52': 116, '53-71': 96, '7-22': 171, '72+': 11},
'sum': 2659},
{'State': 'School',
'freq': {'23-38': 115, '39-52': 71, '53-71': 60, '7-22': 71, '72+': 3},
'sum': 2659},
{'State': 'Cafe',
'freq': {'23-38': 59, '39-52': 20, '53-71': 13, '7-22': 302, '72+': 0},
'sum': 2659},
{'State': 'Others',
'freq': {'23-38': 12, '39-52': 6, '53-71': 3, '7-22': 3, '72+': 2},
'sum': 2659}],
'Maine': [{'State': 'Home',
'freq': {'23-38': 174, '39-52': 155, '53-71': 257, '7-22': 157, '72+': 44},
'sum': 1065},
{'State': 'Work',
'freq': {'23-38': 106, '39-52': 94, '53-71': 118, '7-22': 21, '72+': 7},
'sum': 1065},
{'State': 'Travel',
'freq': {'23-38': 103, '39-52': 77, '53-71': 128, '7-22': 72, '72+': 13},
'sum': 1065},
{'State': 'Public',
'freq': {'23-38': 57, '39-52': 34, '53-71': 60, '7-22': 44, '72+': 5},
'sum': 1065},
{'State': 'OthersHome',
'freq': {'23-38': 81, '39-52': 68, '53-71': 82, '7-22': 66, '72+': 10},
'sum': 1065},
{'State': 'School',
'freq': {'23-38': 56, '39-52': 41, '53-71': 54, '7-22': 37, '72+': 5},
'sum': 1065},
{'State': 'Cafe',
'freq': {'23-38': 18, '39-52': 6, '53-71': 5, '7-22': 126, '72+': 0},
'sum': 1065},
{'State': 'Others',
'freq': {'23-38': 2, '39-52': 4, '53-71': 6, '7-22': 3, '72+': 1},
'sum': 1065}],
'Maryland': [{'State': 'Home',
'freq': {'23-38': 242, '39-52': 239, '53-71': 291, '7-22': 243, '72+': 58},
'sum': 1434},
{'State': 'Work',
'freq': {'23-38': 156, '39-52': 161, '53-71': 153, '7-22': 21, '72+': 4},
'sum': 1434},
{'State': 'Travel',
'freq': {'23-38': 141, '39-52': 131, '53-71': 128, '7-22': 73, '72+': 13},
'sum': 1434},
{'State': 'Public',
'freq': {'23-38': 67, '39-52': 59, '53-71': 59, '7-22': 93, '72+': 3},
'sum': 1434},
{'State': 'OthersHome',
'freq': {'23-38': 103, '39-52': 79, '53-71': 60, '7-22': 81, '72+': 13},
'sum': 1434},
{'State': 'School',
'freq': {'23-38': 79, '39-52': 57, '53-71': 49, '7-22': 54, '72+': 2},
'sum': 1434},
{'State': 'Cafe',
'freq': {'23-38': 25, '39-52': 7, '53-71': 15, '7-22': 158, '72+': 1},
'sum': 1434},
{'State': 'Others',
'freq': {'23-38': 7, '39-52': 15, '53-71': 15, '7-22': 11, '72+': 1},
'sum': 1434}],
'Massachusetts': [{'State': 'Home',
'freq': {'23-38': 408, '39-52': 339, '53-71': 429, '7-22': 321, '72+': 102},
'sum': 2205},
{'State': 'Work',
'freq': {'23-38': 249, '39-52': 220, '53-71': 231, '7-22': 43, '72+': 11},
'sum': 2205},
{'State': 'Travel',
'freq': {'23-38': 240, '39-52': 173, '53-71': 188, '7-22': 112, '72+': 22},
'sum': 2205},
{'State': 'Public',
'freq': {'23-38': 122, '39-52': 75, '53-71': 85, '7-22': 106, '72+': 17},
'sum': 2205},
{'State': 'OthersHome',
'freq': {'23-38': 186, '39-52': 130, '53-71': 120, '7-22': 134, '72+': 19},
'sum': 2205},
{'State': 'School',
'freq': {'23-38': 136, '39-52': 86, '53-71': 82, '7-22': 72, '72+': 7},
'sum': 2205},
{'State': 'Cafe',
'freq': {'23-38': 39, '39-52': 15, '53-71': 7, '7-22': 228, '72+': 1},
'sum': 2205},
{'State': 'Others',
'freq': {'23-38': 10, '39-52': 16, '53-71': 15, '7-22': 7, '72+': 6},
'sum': 2205}],
'Michigan': [{'State': 'Home',
'freq': {'23-38': 427, '39-52': 366, '53-71': 479, '7-22': 395, '72+': 107},
'sum': 2530},
{'State': 'Work',
'freq': {'23-38': 235, '39-52': 208, '53-71': 189, '7-22': 35, '72+': 8},
'sum': 2530},
{'State': 'Travel',
'freq': {'23-38': 272, '39-52': 200, '53-71': 204, '7-22': 151, '72+': 36},
'sum': 2530},
{'State': 'Public',
'freq': {'23-38': 167, '39-52': 80, '53-71': 95, '7-22': 151, '72+': 23},
'sum': 2530},
{'State': 'OthersHome',
'freq': {'23-38': 213, '39-52': 135, '53-71': 129, '7-22': 185, '72+': 24},
'sum': 2530},
{'State': 'School',
'freq': {'23-38': 161, '39-52': 114, '53-71': 85, '7-22': 108, '72+': 14},
'sum': 2530},
{'State': 'Cafe',
'freq': {'23-38': 63, '39-52': 25, '53-71': 12, '7-22': 267, '72+': 2},
'sum': 2530},
{'State': 'Others',
'freq': {'23-38': 11, '39-52': 15, '53-71': 15, '7-22': 10, '72+': 2},
'sum': 2530}],
'Minnesota': [{'State': 'Home',
'freq': {'23-38': 327, '39-52': 263, '53-71': 276, '7-22': 251, '72+': 52},
'sum': 1511},
{'State': 'Work',
'freq': {'23-38': 200, '39-52': 167, '53-71': 116, '7-22': 21, '72+': 3},
'sum': 1511},
{'State': 'Travel',
'freq': {'23-38': 219, '39-52': 167, '53-71': 120, '7-22': 96, '72+': 5},
'sum': 1511},
{'State': 'Public',
'freq': {'23-38': 91, '39-52': 55, '53-71': 54, '7-22': 59, '72+': 6},
'sum': 1511},
{'State': 'OthersHome',
'freq': {'23-38': 142, '39-52': 91, '53-71': 77, '7-22': 113, '72+': 8},
'sum': 1511},
{'State': 'School',
'freq': {'23-38': 107, '39-52': 84, '53-71': 60, '7-22': 54, '72+': 2},
'sum': 1511},
{'State': 'Cafe',
'freq': {'23-38': 35, '39-52': 14, '53-71': 7, '7-22': 189, '72+': 1},
'sum': 1511},
{'State': 'Others',
'freq': {'23-38': 2, '39-52': 8, '53-71': 12, '7-22': 13, '72+': 1},
'sum': 1511}],
'Mississippi': [{'State': 'Home',
'freq': {'23-38': 352, '39-52': 310, '53-71': 300, '7-22': 298, '72+': 63},
'sum': 2271},
{'State': 'Work',
'freq': {'23-38': 185, '39-52': 180, '53-71': 115, '7-22': 22, '72+': 2},
'sum': 2271},
{'State': 'Travel',
'freq': {'23-38': 194, '39-52': 182, '53-71': 119, '7-22': 143, '72+': 19},
'sum': 2271},
{'State': 'Public',
'freq': {'23-38': 93, '39-52': 63, '53-71': 49, '7-22': 131, '72+': 8},
'sum': 2271},
{'State': 'OthersHome',
'freq': {'23-38': 115, '39-52': 72, '53-71': 38, '7-22': 94, '72+': 8},
'sum': 2271},
{'State': 'School',
'freq': {'23-38': 56, '39-52': 68, '53-71': 43, '7-22': 46, '72+': 3},
'sum': 2271},
{'State': 'Cafe',
'freq': {'23-38': 51, '39-52': 20, '53-71': 6, '7-22': 313, '72+': 0},
'sum': 2271},
{'State': 'Others',
'freq': {'23-38': 5, '39-52': 4, '53-71': 1, '7-22': 1, '72+': 4},
'sum': 2271}],
'Missouri': [{'State': 'Home',
'freq': {'23-38': 255, '39-52': 242, '53-71': 283, '7-22': 244, '72+': 74},
'sum': 1624},
{'State': 'Work',
'freq': {'23-38': 186, '39-52': 165, '53-71': 131, '7-22': 28, '72+': 8},
'sum': 1624},
{'State': 'Travel',
'freq': {'23-38': 168, '39-52': 146, '53-71': 134, '7-22': 110, '72+': 17},
'sum': 1624},
{'State': 'Public',
'freq': {'23-38': 78, '39-52': 65, '53-71': 62, '7-22': 71, '72+': 8},
'sum': 1624},
{'State': 'OthersHome',
'freq': {'23-38': 137, '39-52': 90, '53-71': 78, '7-22': 90, '72+': 11},
'sum': 1624},
{'State': 'School',
'freq': {'23-38': 98, '39-52': 70, '53-71': 59, '7-22': 52, '72+': 7},
'sum': 1624},
{'State': 'Cafe',
'freq': {'23-38': 35, '39-52': 12, '53-71': 3, '7-22': 203, '72+': 2},
'sum': 1624},
{'State': 'Others',
'freq': {'23-38': 15, '39-52': 8, '53-71': 11, '7-22': 7, '72+': 6},
'sum': 1624}],
'Montana': [{'State': 'Home',
'freq': {'23-38': 355, '39-52': 348, '53-71': 502, '7-22': 339, '72+': 98},
'sum': 2385},
{'State': 'Work',
'freq': {'23-38': 210, '39-52': 235, '53-71': 236, '7-22': 37, '72+': 6},
'sum': 2385},
{'State': 'Travel',
'freq': {'23-38': 220, '39-52': 197, '53-71': 218, '7-22': 160, '72+': 25},
'sum': 2385},
{'State': 'Public',
'freq': {'23-38': 122, '39-52': 92, '53-71': 79, '7-22': 134, '72+': 9},
'sum': 2385},
{'State': 'OthersHome',
'freq': {'23-38': 185, '39-52': 109, '53-71': 126, '7-22': 182, '72+': 13},
'sum': 2385},
{'State': 'School',
'freq': {'23-38': 145, '39-52': 94, '53-71': 87, '7-22': 93, '72+': 5},
'sum': 2385},
{'State': 'Cafe',
'freq': {'23-38': 38, '39-52': 12, '53-71': 9, '7-22': 274, '72+': 1},
'sum': 2385},
{'State': 'Others',
'freq': {'23-38': 6, '39-52': 6, '53-71': 14, '7-22': 1, '72+': 5},
'sum': 2385}],
'Nebraska': [{'State': 'Home',
'freq': {'23-38': 269, '39-52': 208, '53-71': 222, '7-22': 260, '72+': 52},
'sum': 1449},
{'State': 'Work',
'freq': {'23-38': 193, '39-52': 125, '53-71': 121, '7-22': 28, '72+': 10},
'sum': 1449},
{'State': 'Travel',
'freq': {'23-38': 168, '39-52': 115, '53-71': 97, '7-22': 104, '72+': 14},
'sum': 1449},
{'State': 'Public',
'freq': {'23-38': 80, '39-52': 59, '53-71': 38, '7-22': 87, '72+': 7},
'sum': 1449},
{'State': 'OthersHome',
'freq': {'23-38': 120, '39-52': 67, '53-71': 38, '7-22': 99, '72+': 12},
'sum': 1449},
{'State': 'School',
'freq': {'23-38': 75, '39-52': 49, '53-71': 36, '7-22': 48, '72+': 7},
'sum': 1449},
{'State': 'Cafe',
'freq': {'23-38': 35, '39-52': 23, '53-71': 8, '7-22': 210, '72+': 3},
'sum': 1449},
{'State': 'Others',
'freq': {'23-38': 9, '39-52': 9, '53-71': 9, '7-22': 7, '72+': 1},
'sum': 1449}],
'Nevada': [{'State': 'Home',
'freq': {'23-38': 283, '39-52': 228, '53-71': 232, '7-22': 239, '72+': 39},
'sum': 1378},
{'State': 'Work',
'freq': {'23-38': 162, '39-52': 133, '53-71': 87, '7-22': 34, '72+': 6},
'sum': 1378},
{'State': 'Travel',
'freq': {'23-38': 141, '39-52': 125, '53-71': 106, '7-22': 87, '72+': 14},
'sum': 1378},
{'State': 'Public',
'freq': {'23-38': 73, '39-52': 56, '53-71': 42, '7-22': 53, '72+': 3},
'sum': 1378},
{'State': 'OthersHome',
'freq': {'23-38': 78, '39-52': 53, '53-71': 42, '7-22': 63, '72+': 5},
'sum': 1378},
{'State': 'School',
'freq': {'23-38': 65, '39-52': 64, '53-71': 52, '7-22': 43, '72+': 4},
'sum': 1378},
{'State': 'Cafe',
'freq': {'23-38': 39, '39-52': 18, '53-71': 5, '7-22': 162, '72+': 0},
'sum': 1378},
{'State': 'Others',
'freq': {'23-38': 3, '39-52': 2, '53-71': 3, '7-22': 1, '72+': 1},
'sum': 1378}],
'New Hampshire': [{'State': 'Home',
'freq': {'23-38': 246, '39-52': 273, '53-71': 343, '7-22': 245, '72+': 84},
'sum': 1560},
{'State': 'Work',
'freq': {'23-38': 137, '39-52': 172, '53-71': 173, '7-22': 19, '72+': 2},
'sum': 1560},
{'State': 'Travel',
'freq': {'23-38': 143, '39-52': 131, '53-71': 144, '7-22': 67, '72+': 28},
'sum': 1560},
{'State': 'Public',
'freq': {'23-38': 64, '39-52': 59, '53-71': 70, '7-22': 68, '72+': 16},
'sum': 1560},
{'State': 'OthersHome',
'freq': {'23-38': 98, '39-52': 104, '53-71': 100, '7-22': 97, '72+': 19},
'sum': 1560},
{'State': 'School',
'freq': {'23-38': 71, '39-52': 68, '53-71': 58, '7-22': 35, '72+': 6},
'sum': 1560},
{'State': 'Cafe',
'freq': {'23-38': 25, '39-52': 11, '53-71': 8, '7-22': 186, '72+': 2},
'sum': 1560},
{'State': 'Others',
'freq': {'23-38': 5, '39-52': 10, '53-71': 12, '7-22': 9, '72+': 0},
'sum': 1560}],
'New Jersey': [{'State': 'Home',
'freq': {'23-38': 441, '39-52': 447, '53-71': 483, '7-22': 377, '72+': 109},
'sum': 2498},
{'State': 'Work',
'freq': {'23-38': 253, '39-52': 282, '53-71': 245, '7-22': 26, '72+': 11},
'sum': 2498},
{'State': 'Travel',
'freq': {'23-38': 250, '39-52': 253, '53-71': 221, '7-22': 147, '72+': 25},
'sum': 2498},
{'State': 'Public',
'freq': {'23-38': 130, '39-52': 97, '53-71': 104, '7-22': 143, '72+': 16},
'sum': 2498},
{'State': 'OthersHome',
'freq': {'23-38': 187, '39-52': 167, '53-71': 114, '7-22': 156, '72+': 34},
'sum': 2498},
{'State': 'School',
'freq': {'23-38': 118, '39-52': 108, '53-71': 69, '7-22': 70, '72+': 8},
'sum': 2498},
{'State': 'Cafe',
'freq': {'23-38': 51, '39-52': 19, '53-71': 7, '7-22': 307, '72+': 1},
'sum': 2498},
{'State': 'Others',
'freq': {'23-38': 13, '39-52': 13, '53-71': 14, '7-22': 7, '72+': 1},
'sum': 2498}],
'New Mexico': [{'State': 'Home',
'freq': {'23-38': 341, '39-52': 261, '53-71': 337, '7-22': 298, '72+': 71},
'sum': 2096},
{'State': 'Work',
'freq': {'23-38': 155, '39-52': 162, '53-71': 147, '7-22': 20, '72+': 9},
'sum': 2096},
{'State': 'Travel',
'freq': {'23-38': 195, '39-52': 137, '53-71': 140, '7-22': 123, '72+': 28},
'sum': 2096},
{'State': 'Public',
'freq': {'23-38': 119, '39-52': 64, '53-71': 59, '7-22': 109, '72+': 14},
'sum': 2096},
{'State': 'OthersHome',
'freq': {'23-38': 102, '39-52': 80, '53-71': 68, '7-22': 92, '72+': 11},
'sum': 2096},
{'State': 'School',
'freq': {'23-38': 108, '39-52': 97, '53-71': 72, '7-22': 71, '72+': 13},
'sum': 2096},
{'State': 'Cafe',
'freq': {'23-38': 66, '39-52': 23, '53-71': 3, '7-22': 249, '72+': 1},
'sum': 2096},
{'State': 'Others',
'freq': {'23-38': 1, '39-52': 7, '53-71': 15, '7-22': 10, '72+': 0},
'sum': 2096}],
'New York': [{'State': 'Home',
'freq': {'23-38': 817, '39-52': 695, '53-71': 876, '7-22': 685, '72+': 161},
'sum': 4803},
{'State': 'Work',
'freq': {'23-38': 449, '39-52': 410, '53-71': 384, '7-22': 50, '72+': 13},
'sum': 4803},
{'State': 'Travel',
'freq': {'23-38': 449, '39-52': 317, '53-71': 306, '7-22': 219, '72+': 39},
'sum': 4803},
{'State': 'Public',
'freq': {'23-38': 263, '39-52': 163, '53-71': 146, '7-22': 215, '72+': 34},
'sum': 4803},
{'State': 'OthersHome',
'freq': {'23-38': 305, '39-52': 206, '53-71': 213, '7-22': 225, '72+': 34},
'sum': 4803},
{'State': 'School',
'freq': {'23-38': 243, '39-52': 141, '53-71': 145, '7-22': 100, '72+': 20},
'sum': 4803},
{'State': 'Cafe',
'freq': {'23-38': 99, '39-52': 37, '53-71': 22, '7-22': 433, '72+': 1},
'sum': 4803},
{'State': 'Others',
'freq': {'23-38': 33, '39-52': 14, '53-71': 32, '7-22': 17, '72+': 4},
'sum': 4803}],
'North Carolina': [{'State': 'Home',
'freq': {'23-38': 391, '39-52': 380, '53-71': 406, '7-22': 386, '72+': 78},
'sum': 2599},
{'State': 'Work',
'freq': {'23-38': 204, '39-52': 246, '53-71': 183, '7-22': 30, '72+': 5},
'sum': 2599},
{'State': 'Travel',
'freq': {'23-38': 207, '39-52': 227, '53-71': 167, '7-22': 169, '72+': 27},
'sum': 2599},
{'State': 'Public',
'freq': {'23-38': 132, '39-52': 96, '53-71': 66, '7-22': 139, '72+': 11},
'sum': 2599},
{'State': 'OthersHome',
'freq': {'23-38': 153, '39-52': 126, '53-71': 82, '7-22': 142, '72+': 7},
'sum': 2599},
{'State': 'School',
'freq': {'23-38': 111, '39-52': 103, '53-71': 65, '7-22': 76, '72+': 8},
'sum': 2599},
{'State': 'Cafe',
'freq': {'23-38': 47, '39-52': 23, '53-71': 18, '7-22': 298, '72+': 0},
'sum': 2599},
{'State': 'Others',
'freq': {'23-38': 12, '39-52': 13, '53-71': 11, '7-22': 6, '72+': 3},
'sum': 2599}],
'North Dakota': [{'State': 'Home',
'freq': {'23-38': 336, '39-52': 225, '53-71': 280, '7-22': 255, '72+': 43},
'sum': 1703},
{'State': 'Work',
'freq': {'23-38': 215, '39-52': 149, '53-71': 140, '7-22': 45, '72+': 4},
'sum': 1703},
{'State': 'Travel',
'freq': {'23-38': 196, '39-52': 114, '53-71': 96, '7-22': 105, '72+': 9},
'sum': 1703},
{'State': 'Public',
'freq': {'23-38': 94, '39-52': 57, '53-71': 35, '7-22': 60, '72+': 1},
'sum': 1703},
{'State': 'OthersHome',
'freq': {'23-38': 176, '39-52': 79, '53-71': 52, '7-22': 104, '72+': 7},
'sum': 1703},
{'State': 'School',
'freq': {'23-38': 109, '39-52': 58, '53-71': 37, '7-22': 54, '72+': 0},
'sum': 1703},
{'State': 'Cafe',
'freq': {'23-38': 39, '39-52': 11, '53-71': 11, '7-22': 192, '72+': 0},
'sum': 1703},
{'State': 'Others',
'freq': {'23-38': 8, '39-52': 2, '53-71': 7, '7-22': 1, '72+': 3},
'sum': 1703}],
'Ohio': [{'State': 'Home',
'freq': {'23-38': 527, '39-52': 400, '53-71': 572, '7-22': 477, '72+': 127},
'sum': 3047},
{'State': 'Work',
'freq': {'23-38': 334, '39-52': 250, '53-71': 252, '7-22': 43, '72+': 9},
'sum': 3047},
{'State': 'Travel',
'freq': {'23-38': 304, '39-52': 209, '53-71': 221, '7-22': 188, '72+': 39},
'sum': 3047},
{'State': 'Public',
'freq': {'23-38': 141, '39-52': 101, '53-71': 79, '7-22': 168, '72+': 19},
'sum': 3047},
{'State': 'OthersHome',
'freq': {'23-38': 261, '39-52': 170, '53-71': 141, '7-22': 250, '72+': 22},
'sum': 3047},
{'State': 'School',
'freq': {'23-38': 161, '39-52': 107, '53-71': 93, '7-22': 122, '72+': 18},
'sum': 3047},
{'State': 'Cafe',
'freq': {'23-38': 54, '39-52': 17, '53-71': 11, '7-22': 363, '72+': 1},
'sum': 3047},
{'State': 'Others',
'freq': {'23-38': 13, '39-52': 8, '53-71': 19, '7-22': 3, '72+': 6},
'sum': 3047}],
'Oklahoma': [{'State': 'Home',
'freq': {'23-38': 300, '39-52': 199, '53-71': 249, '7-22': 228, '72+': 68},
'sum': 1670},
{'State': 'Work',
'freq': {'23-38': 173, '39-52': 134, '53-71': 106, '7-22': 27, '72+': 3},
'sum': 1670},
{'State': 'Travel',
'freq': {'23-38': 173, '39-52': 113, '53-71': 100, '7-22': 80, '72+': 17},
'sum': 1670},
{'State': 'Public',
'freq': {'23-38': 83, '39-52': 46, '53-71': 36, '7-22': 67, '72+': 8},
'sum': 1670},
{'State': 'OthersHome',
'freq': {'23-38': 123, '39-52': 70, '53-71': 41, '7-22': 95, '72+': 7},
'sum': 1670},
{'State': 'School',
'freq': {'23-38': 88, '39-52': 53, '53-71': 34, '7-22': 56, '72+': 8},
'sum': 1670},
{'State': 'Cafe',
'freq': {'23-38': 36, '39-52': 13, '53-71': 9, '7-22': 189, '72+': 3},
'sum': 1670},
{'State': 'Others',
'freq': {'23-38': 4, '39-52': 2, '53-71': 2, '7-22': 2, '72+': 0},
'sum': 1670}],
'Oregon': [{'State': 'Home',
'freq': {'23-38': 335, '39-52': 294, '53-71': 364, '7-22': 297, '72+': 93},
'sum': 1819},
{'State': 'Work',
'freq': {'23-38': 176, '39-52': 199, '53-71': 156, '7-22': 31, '72+': 6},
'sum': 1819},
{'State': 'Travel',
'freq': {'23-38': 206, '39-52': 176, '53-71': 174, '7-22': 129, '72+': 27},
'sum': 1819},
{'State': 'Public',
'freq': {'23-38': 104, '39-52': 88, '53-71': 60, '7-22': 113, '72+': 8},
'sum': 1819},
{'State': 'OthersHome',
'freq': {'23-38': 150, '39-52': 113, '53-71': 90, '7-22': 147, '72+': 18},
'sum': 1819},
{'State': 'School',
'freq': {'23-38': 149, '39-52': 112, '53-71': 91, '7-22': 96, '72+': 10},
'sum': 1819},
{'State': 'Cafe',
'freq': {'23-38': 43, '39-52': 21, '53-71': 11, '7-22': 217, '72+': 1},
'sum': 1819},
{'State': 'Others',
'freq': {'23-38': 18, '39-52': 16, '53-71': 12, '7-22': 18, '72+': 0},
'sum': 1819}],
'Pennsylvania': [{'State': 'Home',
'freq': {'23-38': 512, '39-52': 431, '53-71': 631, '7-22': 472, '72+': 146},
'sum': 3298},
{'State': 'Work',
'freq': {'23-38': 276, '39-52': 278, '53-71': 282, '7-22': 45, '72+': 16},
'sum': 3298},
{'State': 'Travel',
'freq': {'23-38': 325, '39-52': 241, '53-71': 232, '7-22': 186, '72+': 33},
'sum': 3298},
{'State': 'Public',
'freq': {'23-38': 135, '39-52': 90, '53-71': 84, '7-22': 151, '72+': 13},
'sum': 3298},
{'State': 'OthersHome',
'freq': {'23-38': 257, '39-52': 140, '53-71': 181, '7-22': 218, '72+': 22},
'sum': 3298},
{'State': 'School',
'freq': {'23-38': 142, '39-52': 89, '53-71': 106, '7-22': 79, '72+': 10},
'sum': 3298},
{'State': 'Cafe',
'freq': {'23-38': 49, '39-52': 15, '53-71': 9, '7-22': 332, '72+': 0},
'sum': 3298},
{'State': 'Others',
'freq': {'23-38': 27, '39-52': 11, '53-71': 22, '7-22': 15, '72+': 0},
'sum': 3298}],
'Rhode Island': [{'State': 'Home',
'freq': {'23-38': 168, '39-52': 204, '53-71': 248, '7-22': 193, '72+': 53},
'sum': 1150},
{'State': 'Work',
'freq': {'23-38': 100, '39-52': 117, '53-71': 137, '7-22': 19, '72+': 3},
'sum': 1150},
{'State': 'Travel',
'freq': {'23-38': 83, '39-52': 83, '53-71': 113, '7-22': 59, '72+': 11},
'sum': 1150},
{'State': 'Public',
'freq': {'23-38': 33, '39-52': 38, '53-71': 32, '7-22': 67, '72+': 5},
'sum': 1150},
{'State': 'OthersHome',
'freq': {'23-38': 65, '39-52': 54, '53-71': 71, '7-22': 66, '72+': 4},
'sum': 1150},
{'State': 'School',
'freq': {'23-38': 38, '39-52': 26, '53-71': 39, '7-22': 27, '72+': 1},
'sum': 1150},
{'State': 'Cafe',
'freq': {'23-38': 21, '39-52': 4, '53-71': 11, '7-22': 126, '72+': 0},
'sum': 1150},
{'State': 'Others',
'freq': {'23-38': 5, '39-52': 3, '53-71': 9, '7-22': 2, '72+': 2},
'sum': 1150}],
'South Carolina': [{'State': 'Home',
'freq': {'23-38': 249, '39-52': 261, '53-71': 319, '7-22': 258, '72+': 69},
'sum': 1754},
{'State': 'Work',
'freq': {'23-38': 137, '39-52': 155, '53-71': 140, '7-22': 26, '72+': 9},
'sum': 1754},
{'State': 'Travel',
'freq': {'23-38': 125, '39-52': 155, '53-71': 144, '7-22': 100, '72+': 19},
'sum': 1754},
{'State': 'Public',
'freq': {'23-38': 49, '39-52': 62, '53-71': 51, '7-22': 90, '72+': 14},
'sum': 1754},
{'State': 'OthersHome',
'freq': {'23-38': 91, '39-52': 90, '53-71': 79, '7-22': 94, '72+': 16},
'sum': 1754},
{'State': 'School',
'freq': {'23-38': 52, '39-52': 61, '53-71': 46, '7-22': 63, '72+': 11},
'sum': 1754},
{'State': 'Cafe',
'freq': {'23-38': 26, '39-52': 10, '53-71': 7, '7-22': 188, '72+': 1},
'sum': 1754},
{'State': 'Others',
'freq': {'23-38': 6, '39-52': 4, '53-71': 14, '7-22': 8, '72+': 4},
'sum': 1754}],
'South Dakota': [{'State': 'Home',
'freq': {'23-38': 222, '39-52': 173, '53-71': 208, '7-22': 195, '72+': 65},
'sum': 1349},
{'State': 'Work',
'freq': {'23-38': 135, '39-52': 116, '53-71': 113, '7-22': 23, '72+': 6},
'sum': 1349},
{'State': 'Travel',
'freq': {'23-38': 141, '39-52': 83, '53-71': 65, '7-22': 60, '72+': 13},
'sum': 1349},
{'State': 'Public',
'freq': {'23-38': 50, '39-52': 32, '53-71': 18, '7-22': 38, '72+': 7},
'sum': 1349},
{'State': 'OthersHome',
'freq': {'23-38': 83, '39-52': 48, '53-71': 43, '7-22': 66, '72+': 8},
'sum': 1349},
{'State': 'School',
'freq': {'23-38': 66, '39-52': 37, '53-71': 23, '7-22': 27, '72+': 6},
'sum': 1349},
{'State': 'Cafe',
'freq': {'23-38': 20, '39-52': 10, '53-71': 5, '7-22': 158, '72+': 0},
'sum': 1349},
{'State': 'Others',
'freq': {'23-38': 6, '39-52': 4, '53-71': 7, '7-22': 4, '72+': 0},
'sum': 1349}],
'Tennessee': [{'State': 'Home',
'freq': {'23-38': 350, '39-52': 263, '53-71': 354, '7-22': 294, '72+': 83},
'sum': 2122},
{'State': 'Work',
'freq': {'23-38': 179, '39-52': 163, '53-71': 120, '7-22': 37, '72+': 6},
'sum': 2122},
{'State': 'Travel',
'freq': {'23-38': 191, '39-52': 153, '53-71': 137, '7-22': 118, '72+': 20},
'sum': 2122},
{'State': 'Public',
'freq': {'23-38': 87, '39-52': 54, '53-71': 58, '7-22': 93, '72+': 8},
'sum': 2122},
{'State': 'OthersHome',
'freq': {'23-38': 116, '39-52': 100, '53-71': 70, '7-22': 143, '72+': 7},
'sum': 2122},
{'State': 'School',
'freq': {'23-38': 124, '39-52': 90, '53-71': 61, '7-22': 72, '72+': 4},
'sum': 2122},
{'State': 'Cafe',
'freq': {'23-38': 31, '39-52': 7, '53-71': 3, '7-22': 194, '72+': 0},
'sum': 2122},
{'State': 'Others',
'freq': {'23-38': 7, '39-52': 4, '53-71': 3, '7-22': 4, '72+': 2},
'sum': 2122}],
'Texas': [{'State': 'Home',
'freq': {'23-38': 1135,
 '39-52': 890,
 '53-71': 868,
 '7-22': 1028,
 '72+': 176},
'sum': 6324},
{'State': 'Work',
'freq': {'23-38': 649, '39-52': 562, '53-71': 413, '7-22': 103, '72+': 28},
'sum': 6324},
{'State': 'Travel',
'freq': {'23-38': 645, '39-52': 502, '53-71': 370, '7-22': 396, '72+': 63},
'sum': 6324},
{'State': 'Public',
'freq': {'23-38': 353, '39-52': 250, '53-71': 120, '7-22': 356, '72+': 14},
'sum': 6324},
{'State': 'OthersHome',
'freq': {'23-38': 403, '39-52': 266, '53-71': 189, '7-22': 370, '72+': 37},
'sum': 6324},
{'State': 'School',
'freq': {'23-38': 361, '39-52': 270, '53-71': 137, '7-22': 260, '72+': 23},
'sum': 6324},
{'State': 'Cafe',
'freq': {'23-38': 132, '39-52': 58, '53-71': 25, '7-22': 790, '72+': 4},
'sum': 6324},
{'State': 'Others',
'freq': {'23-38': 28, '39-52': 27, '53-71': 37, '7-22': 11, '72+': 6},
'sum': 6324}],
'Utah': [{'State': 'Home',
'freq': {'23-38': 387, '39-52': 241, '53-71': 234, '7-22': 377, '72+': 53},
'sum': 1751},
{'State': 'Work',
'freq': {'23-38': 223, '39-52': 155, '53-71': 133, '7-22': 51, '72+': 7},
'sum': 1751},
{'State': 'Travel',
'freq': {'23-38': 245, '39-52': 140, '53-71': 116, '7-22': 142, '72+': 20},
'sum': 1751},
{'State': 'Public',
'freq': {'23-38': 132, '39-52': 60, '53-71': 44, '7-22': 97, '72+': 14},
'sum': 1751},
{'State': 'OthersHome',
'freq': {'23-38': 196, '39-52': 85, '53-71': 57, '7-22': 151, '72+': 14},
'sum': 1751},
{'State': 'School',
'freq': {'23-38': 100, '39-52': 68, '53-71': 35, '7-22': 56, '72+': 6},
'sum': 1751},
{'State': 'Cafe',
'freq': {'23-38': 60, '39-52': 13, '53-71': 14, '7-22': 204, '72+': 1},
'sum': 1751},
{'State': 'Others',
'freq': {'23-38': 46, '39-52': 20, '53-71': 21, '7-22': 26, '72+': 2},
'sum': 1751}],
'Vermont': [{'State': 'Home',
'freq': {'23-38': 244, '39-52': 266, '53-71': 404, '7-22': 216, '72+': 89},
'sum': 1584},
{'State': 'Work',
'freq': {'23-38': 164, '39-52': 177, '53-71': 195, '7-22': 26, '72+': 7},
'sum': 1584},
{'State': 'Travel',
'freq': {'23-38': 144, '39-52': 132, '53-71': 177, '7-22': 84, '72+': 30},
'sum': 1584},
{'State': 'Public',
'freq': {'23-38': 55, '39-52': 49, '53-71': 84, '7-22': 51, '72+': 11},
'sum': 1584},
{'State': 'OthersHome',
'freq': {'23-38': 86, '39-52': 76, '53-71': 92, '7-22': 89, '72+': 13},
'sum': 1584},
{'State': 'School',
'freq': {'23-38': 84, '39-52': 70, '53-71': 89, '7-22': 42, '72+': 6},
'sum': 1584},
{'State': 'Cafe',
'freq': {'23-38': 24, '39-52': 21, '53-71': 19, '7-22': 171, '72+': 0},
'sum': 1584},
{'State': 'Others',
'freq': {'23-38': 9, '39-52': 8, '53-71': 13, '7-22': 6, '72+': 3},
'sum': 1584}],
'Virginia': [{'State': 'Home',
'freq': {'23-38': 387, '39-52': 351, '53-71': 399, '7-22': 349, '72+': 99},
'sum': 2117},
{'State': 'Work',
'freq': {'23-38': 233, '39-52': 226, '53-71': 181, '7-22': 29, '72+': 9},
'sum': 2117},
{'State': 'Travel',
'freq': {'23-38': 235, '39-52': 202, '53-71': 204, '7-22': 132, '72+': 25},
'sum': 2117},
{'State': 'Public',
'freq': {'23-38': 93, '39-52': 86, '53-71': 88, '7-22': 84, '72+': 14},
'sum': 2117},
{'State': 'OthersHome',
'freq': {'23-38': 155, '39-52': 111, '53-71': 106, '7-22': 134, '72+': 18},
'sum': 2117},
{'State': 'School',
'freq': {'23-38': 116, '39-52': 98, '53-71': 84, '7-22': 68, '72+': 15},
'sum': 2117},
{'State': 'Cafe',
'freq': {'23-38': 33, '39-52': 24, '53-71': 12, '7-22': 233, '72+': 2},
'sum': 2117},
{'State': 'Others',
'freq': {'23-38': 10, '39-52': 15, '53-71': 21, '7-22': 16, '72+': 1},
'sum': 2117}],
'Washington': [{'State': 'Home',
'freq': {'23-38': 428, '39-52': 340, '53-71': 433, '7-22': 314, '72+': 89},
'sum': 2181},
{'State': 'Work',
'freq': {'23-38': 262, '39-52': 218, '53-71': 193, '7-22': 20, '72+': 6},
'sum': 2181},
{'State': 'Travel',
'freq': {'23-38': 295, '39-52': 241, '53-71': 217, '7-22': 123, '72+': 27},
'sum': 2181},
{'State': 'Public',
'freq': {'23-38': 137, '39-52': 111, '53-71': 91, '7-22': 115, '72+': 15},
'sum': 2181},
{'State': 'OthersHome',
'freq': {'23-38': 202, '39-52': 130, '53-71': 130, '7-22': 140, '72+': 23},
'sum': 2181},
{'State': 'School',
'freq': {'23-38': 168, '39-52': 130, '53-71': 109, '7-22': 78, '72+': 10},
'sum': 2181},
{'State': 'Cafe',
'freq': {'23-38': 35, '39-52': 10, '53-71': 9, '7-22': 212, '72+': 2},
'sum': 2181},
{'State': 'Others',
'freq': {'23-38': 16, '39-52': 10, '53-71': 16, '7-22': 4, '72+': 1},
'sum': 2181}],
'West Virginia': [{'State': 'Home',
'freq': {'23-38': 392, '39-52': 399, '53-71': 479, '7-22': 394, '72+': 91},
'sum': 2767},
{'State': 'Work',
'freq': {'23-38': 208, '39-52': 214, '53-71': 190, '7-22': 27, '72+': 10},
'sum': 2767},
{'State': 'Travel',
'freq': {'23-38': 211, '39-52': 178, '53-71': 151, '7-22': 177, '72+': 17},
'sum': 2767},
{'State': 'Public',
'freq': {'23-38': 84, '39-52': 63, '53-71': 66, '7-22': 80, '72+': 6},
'sum': 2767},
{'State': 'OthersHome',
'freq': {'23-38': 142, '39-52': 110, '53-71': 84, '7-22': 171, '72+': 15},
'sum': 2767},
{'State': 'School',
'freq': {'23-38': 115, '39-52': 88, '53-71': 71, '7-22': 89, '72+': 5},
'sum': 2767},
{'State': 'Cafe',
'freq': {'23-38': 45, '39-52': 29, '53-71': 7, '7-22': 285, '72+': 0},
'sum': 2767},
{'State': 'Others',
'freq': {'23-38': 6, '39-52': 10, '53-71': 8, '7-22': 8, '72+': 0},
'sum': 2767}],
'Wisconsin': [{'State': 'Home',
'freq': {'23-38': 273, '39-52': 273, '53-71': 371, '7-22': 303, '72+': 79},
'sum': 1656},
{'State': 'Work',
'freq': {'23-38': 161, '39-52': 172, '53-71': 165, '7-22': 42, '72+': 2},
'sum': 1656},
{'State': 'Travel',
'freq': {'23-38': 168, '39-52': 158, '53-71': 130, '7-22': 111, '72+': 18},
'sum': 1656},
{'State': 'Public',
'freq': {'23-38': 79, '39-52': 70, '53-71': 65, '7-22': 93, '72+': 6},
'sum': 1656},
{'State': 'OthersHome',
'freq': {'23-38': 135, '39-52': 88, '53-71': 89, '7-22': 134, '72+': 9},
'sum': 1656},
{'State': 'School',
'freq': {'23-38': 92, '39-52': 81, '53-71': 65, '7-22': 68, '72+': 5},
'sum': 1656},
{'State': 'Cafe',
'freq': {'23-38': 28, '39-52': 13, '53-71': 7, '7-22': 229, '72+': 0},
'sum': 1656},
{'State': 'Others',
'freq': {'23-38': 4, '39-52': 4, '53-71': 9, '7-22': 4, '72+': 2},
'sum': 1656}]};


var selected = "Washington"
var currentSelect = selected//

d3.select('select').on('change', function Myfunction() {
    var selection = d3.select(d3.event.target)['_groups'][0]["0"].selectedOptions["0"].text;
    currentSelect = selection
    d3.select('#dashboard').html('')
    dashboard('#dashboard',pie_data[selection]);
    console.log(currentSelect)
    
})

// run the function
dashboard('#dashboard',pie_data[currentSelect]);